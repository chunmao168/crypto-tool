
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>å‰ç«¯åŠ å¯†/è§£å¯†/ç°½ç« /é©—ç« å·¥å…·</title>
  <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jsencrypt@3.2.1/bin/jsencrypt.min.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    textarea, input[type="text"] { width: 100%; margin: 5px 0; }
    button { margin: 5px; }
    .section { border: 1px solid #ccc; padding: 10px; margin-top: 15px; }
  </style>
</head>
<body>
  <h2>ğŸ” å‰ç«¯åŠ å¯† / è§£å¯† / ç°½ç«  / é©—ç«  å·¥å…·</h2>

  <!-- AES å€å¡Š -->
  <div class="section">
    <h3>1ï¸âƒ£ AES åŠ å¯†/è§£å¯†</h3>
    <label>AES é‡‘é‘°ï¼š</label>
    <input type="text" id="aesKey" placeholder="è«‹è¼¸å…¥ AES é‡‘é‘° (16å­—å…ƒå»ºè­°)">
    <label>è¼¸å…¥è¨Šæ¯ï¼š</label>
    <textarea id="aesInput" rows="4"></textarea>
    <button onclick="encryptAES()">ğŸ” åŠ å¯†</button>
    <button onclick="decryptAES()">ğŸ”“ è§£å¯†</button>
    <label>çµæœï¼š</label>
    <textarea id="aesOutput" rows="4" readonly></textarea>
  </div>

  <!-- æª”æ¡ˆåŠ å¯† -->
  <div class="section">
    <h3>2ï¸âƒ£ æª”æ¡ˆåŠ å¯† / è§£å¯†ï¼ˆæ–‡å­—æª”ï¼‰</h3>
    <input type="file" id="fileInput">
    <button onclick="encryptFile()">ğŸ” åŠ å¯†æª”æ¡ˆ</button>
    <button onclick="decryptFile()">ğŸ”“ è§£å¯†æª”æ¡ˆ</button>
    <a id="downloadLink" style="display:none;" download="output.txt">ğŸ“¥ ä¸‹è¼‰çµæœ</a>
  </div>

  <!-- RSA ç°½ç« å€å¡Š -->
  <div class="section">
    <h3>3ï¸âƒ£ RSA ç°½ç«  / é©—ç« </h3>
    <button onclick="generateRSAKeys()">ğŸ”‘ ç”¢ç”Ÿ RSA é‡‘é‘°å°</button>
    <button onclick="exportKeys()">ğŸ“¤ åŒ¯å‡ºé‡‘é‘°</button>
    <input type="file" id="importKeyInput">
    <button onclick="importKey()">ğŸ“¥ åŒ¯å…¥é‡‘é‘°</button>
    <label>è¨Šæ¯å…§å®¹ï¼š</label>
    <textarea id="rsaMessage" rows="4"></textarea>
    <button onclick="signRSA()">ğŸ–Š ç°½ç« </button>
    <button onclick="verifyRSA()">âœ… é©—ç« </button>
    <label>ç°½ç« ï¼š</label>
    <textarea id="rsaSignature" rows="4"></textarea>
  </div>

  <script>
    let privateKey, publicKey;

    function encryptAES() {
      const key = document.getElementById('aesKey').value;
      const text = document.getElementById('aesInput').value;
      if (!key) return alert('è«‹è¼¸å…¥ AES é‡‘é‘°');
      const ciphertext = CryptoJS.AES.encrypt(text, key).toString();
      document.getElementById('aesOutput').value = ciphertext;
    }

    function decryptAES() {
      const key = document.getElementById('aesKey').value;
      const ciphertext = document.getElementById('aesInput').value;
      if (!key) return alert('è«‹è¼¸å…¥ AES é‡‘é‘°');
      try {
        const bytes = CryptoJS.AES.decrypt(ciphertext, key);
        const plaintext = bytes.toString(CryptoJS.enc.Utf8);
        document.getElementById('aesOutput').value = plaintext || 'âŒ è§£å¯†å¤±æ•—';
      } catch (e) {
        document.getElementById('aesOutput').value = 'âŒ è§£å¯†éŒ¯èª¤';
      }
    }

    function encryptFile() {
      const file = document.getElementById('fileInput').files[0];
      const key = document.getElementById('aesKey').value;
      if (!file || !key) return alert('è«‹é¸æ“‡æª”æ¡ˆä¸¦è¼¸å…¥é‡‘é‘°');
      const reader = new FileReader();
      reader.onload = () => {
        const encrypted = CryptoJS.AES.encrypt(reader.result, key).toString();
        downloadText(encrypted, 'encrypted.txt');
      };
      reader.readAsText(file);
    }

    function decryptFile() {
      const file = document.getElementById('fileInput').files[0];
      const key = document.getElementById('aesKey').value;
      if (!file || !key) return alert('è«‹é¸æ“‡æª”æ¡ˆä¸¦è¼¸å…¥é‡‘é‘°');
      const reader = new FileReader();
      reader.onload = () => {
        try {
          const bytes = CryptoJS.AES.decrypt(reader.result, key);
          const decrypted = bytes.toString(CryptoJS.enc.Utf8);
          downloadText(decrypted || 'è§£å¯†å¤±æ•—', 'decrypted.txt');
        } catch (e) {
          downloadText('è§£å¯†éŒ¯èª¤', 'decrypted.txt');
        }
      };
      reader.readAsText(file);
    }

    function downloadText(text, filename) {
      const blob = new Blob([text], { type: 'text/plain' });
      const link = document.getElementById('downloadLink');
      link.href = URL.createObjectURL(blob);
      link.download = filename;
      link.style.display = 'inline';
      link.click();
    }

    function generateRSAKeys() {
      const crypt = new JSEncrypt({ default_key_size: 2048 });
      crypt.getKey();
      privateKey = crypt.getPrivateKey();
      publicKey = crypt.getPublicKey();
      alert('RSA é‡‘é‘°å·²ç”¢ç”Ÿ');
    }

    function signRSA() {
      if (!privateKey) return alert('è«‹å…ˆç”¢ç”Ÿæˆ–åŒ¯å…¥ç§é‘°');
      const text = document.getElementById('rsaMessage').value;
      const crypt = new JSEncrypt();
      crypt.setPrivateKey(privateKey);
      const signature = crypt.sign(text, CryptoJS.SHA256, 'sha256');
      document.getElementById('rsaSignature').value = signature;
    }

    function verifyRSA() {
      if (!publicKey) return alert('è«‹å…ˆç”¢ç”Ÿæˆ–åŒ¯å…¥å…¬é‘°');
      const text = document.getElementById('rsaMessage').value;
      const sig = document.getElementById('rsaSignature').value;
      const crypt = new JSEncrypt();
      crypt.setPublicKey(publicKey);
      const verified = crypt.verify(text, sig, CryptoJS.SHA256);
      alert(verified ? 'âœ… é©—ç« æˆåŠŸ' : 'âŒ é©—ç« å¤±æ•—');
    }

    function exportKeys() {
      if (!privateKey || !publicKey) return alert('è«‹å…ˆç”¢ç”Ÿé‡‘é‘°');
      downloadText(privateKey, 'private.pem');
      setTimeout(() => downloadText(publicKey, 'public.pem'), 1000);
    }

    function importKey() {
      const file = document.getElementById('importKeyInput').files[0];
      if (!file) return alert('è«‹é¸æ“‡ PEM æª”æ¡ˆ');
      const reader = new FileReader();
      reader.onload = () => {
        const content = reader.result;
        if (content.includes('PRIVATE KEY')) privateKey = content;
        if (content.includes('PUBLIC KEY')) publicKey = content;
        alert('é‡‘é‘°åŒ¯å…¥å®Œæˆ');
      };
      reader.readAsText(file);
    }
  </script>
</body>
</html>
